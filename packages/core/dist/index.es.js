function v(t,e,n=!1){var l;let r="string"!=typeof e?null==(l=null==e?void 0:e.selector)?void 0:l.value:"";if(r){if(r=r.replaceAll("_"," "),r.startsWith("&")){const e=null==r?void 0:r.replace("&",":scope");return n?t.querySelector(e):t.querySelectorAll(e)}return r}return t}function W(t){return!(null===t||"object"!=typeof t||Array.isArray(t)||t instanceof HTMLElement)}function x(t,...e){if(!e.length)return t;const n=e.shift();if(W(t)&&W(n))for(const e in n)"__proto__"===e||"constructor"===e||"prototype"===e||(W(n[e])?(t[e]||Object.assign(t,{[e]:{}}),x(t[e],n[e])):Object.assign(t,{[e]:n[e]}));return e.length?x(t,...e):t}function F(t){const e=t.match(/^\[([^\]]+)]:(.*)/);return e?{content:e[1],restOfString:e[2]}:null}function P(t,e,n){if("string"!=typeof t)return t;const l=t.replace(/^\[|]$/g,"").replaceAll("_"," ");return l.startsWith("&")?v(e,t,["trigger"].includes(n)):"true"===l||"false"===l?"true"===l:isNaN(Number(l))?l:l.includes(".")?parseFloat(l):parseInt(l,10)}function H(t,e=!1,n){const l={};return t.split(" ").forEach((t=>{var r;const i=F(t);i&&(t=i.restOfString,l.selector={},l.selector.value=i.content);const s=t.split(":").filter((t=>!t.includes("@"))),[o,a]=s;if(!a&&e){const e=t.split("-"),r=e[0],i=e[1];if(!r||!i)return;return void(l[r]=P(i,n,r))}if("tl"===o&&a.startsWith("["))return void(l.tl={value:null==(r=F(a+":"))?void 0:r.content});if(!a)return;const c=a.split("|");l[o]||(l[o]={}),c.forEach((t=>{if(!t)return;let[e,r]=t.split(/-(.+)/);r=P(r,n,e);const i=e.split(".");let s=l[o];i.forEach(((t,e)=>{e===i.length-1?s[t]=r:(s[t]||(s[t]={}),s=s[t])}))}))})),l}function K(t,e,n){const l=t.match(/(?:@(\w+):)?tl(?:\/(\w+))?/);if(l){const t=l[1],r={id:l[2]??"",breakpoint:n};if(t){if(null==e||!e[t])return null;r.breakpoint=e[t]??n}return r}return null}function L(t,e,n){const l={};return t.split(" ").forEach((t=>{const r=t.match(/@(\w+):/);if(!r)return l[n]||(l[n]=[]),void l[n].push(t);const i=r[1],s=null==e?void 0:e[i];s&&(l[s]||(l[s]=[]),l[s].push(t.replace(r[0],"")))})),l}function Q(t,e){let n=null;return function(...l){null!==n&&clearTimeout(n),n=window.setTimeout((()=>{t(...l)}),e)}}function R(t){var e,n;if(!t||null==(n=null==(e=null==t?void 0:t.lib)?void 0:e.gsap)||!n.core)throw new Error("GSAP not found");const{lib:{gsap:{core:l}},...r}=t,i=x({breakpoints:{default:"(min-width: 1px)"},dataAttribute:"data-animate",element:document,watch:!1},r),s=i.breakpoints.default,o=i.breakpoints,a=[],c=(t=!1)=>`${t?"[":""}${i.dataAttribute}${t?"]":""}`,u=t=>{const e=t.getAttribute(c())||"";let n="";return null!=i&&i.className&&(n=(t.getAttribute("class")||"").split(" ").filter((t=>t.includes(i.className))).map((t=>t.replace(`${null==i?void 0:i.className}-`,""))).join(" ")),`${e} ${n}`.trim()},f=(t=i.element)=>Array.from(t.querySelectorAll(`${c(!0)}${i.className?`, [class^="${i.className}"], [class*="${i.className}"]`:""}`)),d=()=>Math.random().toString(36).substring(2,15),m=t=>"tl"===t||t.includes("tl/")||t.endsWith(":tl"),p=t=>a.find((e=>e.elements.has(t))),b=t=>a.findIndex((e=>e.elements.has(t))),h=Q((function(t,e){const n=p(t.target),r=b(t.target);r>-1&&null!=n&&n.timeline&&(n.timeline.progress(0).kill(),a.splice(r,1),Object.values(e).forEach((e=>{Object.entries(e).forEach((([n])=>{if("selector"===n){const n=[...v(t.target,e),t.target];l.killTweensOf(n),l.set(n,{clearProps:"all"})}}))}))),N(null!=n&&n.timeline?[...Array.from(n.elements.keys()),...null!=n&&n.timelineElement?[null==n?void 0:n.timelineElement]:[]]:[t.target],!0)}),"object"==typeof i.watch&&i.watch.debounceTime||500);function g(t){const e=[...Object.entries(L(u(t),o,s)).map((([e,n])=>({breakpoint:e,element:t,data:H(n.join(" "),!1,t)})))],n={};return e.forEach((t=>{null!=n&&n[t.breakpoint]||(n[t.breakpoint]={}),n[t.breakpoint]=t.data})),n}function E(t=f()){const e=[];t.forEach((t=>{u(t).split(" ").some((t=>m(t)))&&(e.push(...function(t){const e=[],n=u(t),l=n.split(" ");if(l.some((t=>m(t)))){const r=K(n,o,s),c=new Map;[...f(t),...null!=r&&r.id?document.querySelectorAll(`[${i.dataAttribute}*="tl:${r.id}"]${i.className?`, [class^="${i.className}-tl:${r.id}"], [class*="${i.className}-tl:${r.id}"]`:""}`):[]].forEach((n=>{n!==t&&(c.set(n,g(n)),e.push(n))}));const u=H(l.filter((t=>!m(t))).join(" "),!0,t),p=(null==r?void 0:r.breakpoint)||s;a.push({breakpoint:p,data:u,elements:c,id:(null==r?void 0:r.id)||d(),timelineElement:t})}return e}(t)),e.push(t))})),t.forEach((t=>{var n;if(e.includes(t))return;const l=null==(n=a.find((e=>{var n;return(null==(n=e.elements)?void 0:n.has(t))&&e.breakpoint})))?void 0:n.breakpoint,r=a.find((e=>{var n;return null==(n=e.elements)?void 0:n.has(t)})),i=new Map;r||(i.set(t,g(t)),a.push({breakpoint:l||s,data:{},elements:i,id:d()}))}))}function N(t=f(),e=!1){E(t),l.matchMedia().add(Object.fromEntries(Object.values({[s]:s,...o||{}}).map((t=>[t,t]))),(t=>{const n={};(e?[a[a.length-1]]:a).reduce(((t,e)=>new Map([...t,...e.elements])),new Map).forEach(((e,r)=>{let i={};Object.entries(e).forEach((([e,n])=>{var l;null!=(l=t.conditions)&&l[e]&&(i=x(i,n))}));const s=p(r),o=b(r);s&&(null!=n&&n[null==s?void 0:s.id]||(n[null==s?void 0:s.id]=l.timeline(null==s?void 0:s.data),a[o].timeline=n[null==s?void 0:s.id]),function(t,e,n){var l;const r=e.tl?null==(l=Object.values(e.tl))?void 0:l[0]:void 0;if(e.to&&e.from)n.fromTo(v(t,e),e.from,e.to,r);else if(e.to||e.from){const l=e.to?"to":"from";n[l](v(t,e),e[l],r)}}(r,i,n[null==s?void 0:s.id]))}))}))}return N(),i.watch&&function(){const t=i.element,e=new MutationObserver((function(t){t.forEach((function(t){var e,n;const l="attributes"===t.type&&t.attributeName===i.dataAttribute,r=i.className&&"class"===t.attributeName&&(null==(e=t.target.getAttribute("class"))?void 0:e.includes(i.className));if(!l&&!r)return;const s=g(t.target),o=null==(n=a.find((e=>e.elements.has(t.target))))?void 0:n.elements.get(t.target);JSON.stringify(s)!==JSON.stringify(o)&&h(t,s)}))})),n={attributes:!0,attributeFilter:[i.dataAttribute,...i.className?["class"]:[]],subtree:!0};e.observe(t,n)}(),{breakpoints:o,state:i,timelines:a}}export{R as default};