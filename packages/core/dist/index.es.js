function T(t,e,n=!1){var r;const o="string"!=typeof e?null==(r=null==e?void 0:e.selector)?void 0:r.value:"";if(o){if(o.startsWith("&")){const e=null==o?void 0:o.replace("&",":scope ");return n?t.querySelector(e):t.querySelectorAll(e)}return o}return t}function $(t){return!(null===t||"object"!=typeof t||Array.isArray(t)||t instanceof HTMLElement)}function W(t,...e){if(!e.length)return t;const n=e.shift();if($(t)&&$(n))for(const e in n)"__proto__"===e||"constructor"===e||"prototype"===e||($(n[e])?(t[e]||Object.assign(t,{[e]:{}}),W(t[e],n[e])):Object.assign(t,{[e]:n[e]}));return e.length?W(t,...e):t}function N(t){const e=t.match(/^\[([^\]]+)]:(.*)/);return e?{content:e[1],restOfString:e[2]}:null}function V(t,e,n){if("string"!=typeof t)return t;const r=t.replace(/^\[|]$/g,"").replaceAll("_"," ");return r.startsWith("&")?T(e,t,["trigger"].includes(n)):"true"===r||"false"===r?"true"===r:isNaN(Number(r))?r:r.includes(".")?parseFloat(r):parseInt(r,10)}function F(t,e=!1,n){const r={};return t.split(" ").forEach((t=>{var o;const i=N(t);i&&(t=i.restOfString,r.selector={},r.selector.value=i.content);const l=t.split(":").filter((t=>!t.includes("@"))),[s,c]=l;if(!c&&e){const e=t.split("-"),o=e[0],i=e[1];if(!o||!i)return;return void(r[o]=V(i,n,o))}if("tl"===s&&c.startsWith("["))return void(r.tl={value:null==(o=N(c+":"))?void 0:o.content});if(!c)return;const a=c.split("|");r[s]||(r[s]={}),a.forEach((t=>{if(!t)return;let[e,o]=t.split(/-(.+)/);o=V(o,n,e);const i=e.split(".");let l=r[s];i.forEach(((t,e)=>{e===i.length-1?l[t]=o:(l[t]||(l[t]={}),l=l[t])}))}))})),r}function I(t){var e;if(null==(e=t.gsap)||!e.core)throw new Error("GSAP not found");const{gsap:{core:n},...r}=t,o=W({dataAttribute:"data-animate",element:document,breakpoints:{default:"(min-width: 1px)"}},r),i=o.breakpoints.default,l=o.breakpoints;let s=[],c=[],a=new Map;const u=t=>(t.getAttribute(d())||"").trim(),f=(t=o.element)=>t.querySelectorAll(d(!0)),d=(t=!1)=>`${t?"[":""}${o.dataAttribute}${t?"]":""}`;function p(){const t=[],e=f(),r=t=>"tl"===t||t.includes("tl/")||t.endsWith(":tl");e.forEach((e=>{const s=u(e),a=s.split(" ");if(a.some((t=>r(t)))){const u=function(t){const e=t.match(/(?:@(\w+):)?tl(?:\/(\w+))?/);if(e){const t=e[1],n={id:e[2]??"",breakpoint:i};if(t){if(null==l||!l[t])return null;n.breakpoint=l[t]}return n}return null}(s),d=[];[...f(e),...null!=u&&u.id?document.querySelectorAll(`[${o.dataAttribute}*="tl:${u.id}"]`):[]].forEach((t=>{d.push(t)}));const p=F(a.filter((t=>!r(t))).join(" "),!0,e);return t.push(e),void c.push({id:(null==u?void 0:u.id)||Math.random().toString(36).substring(2,15),data:p,breakpoint:(null==u?void 0:u.breakpoint)||i,elements:d,timeline:n.timeline(p)})}})),e.forEach((e=>{var n;if(t.includes(e))return;const r=null==(n=c.find((t=>t.elements.some((t=>t===e))&&t.breakpoint)))?void 0:n.breakpoint;s.push(...Object.entries(function(t){const e={};return t.split(" ").forEach((t=>{const n=t.match(/@(\w+):/);if(!n)return e[i]||(e[i]=[]),void e[i].push(t);const r=n[1];null!=l&&l[r]&&(e[l[r]]||(e[l[r]]=[]),e[l[r]].push(t.replace(n[0],"")))})),e}(u(e))).map((([t,n])=>({breakpoint:t??r,element:e,data:F(n.join(" "),!1,e)}))))})),s.forEach((t=>{a.has(t.element)||a.set(t.element,{});const e={[t.breakpoint]:t.data};a.set(t.element,{...a.get(t.element),...e})}))}function m(){h(),p();const t=n.matchMedia();t.add(Object.fromEntries(Object.values({[i]:i,...l||{}}).map((t=>[t,t]))),(t=>{a.forEach(((e,r)=>{var o;let i={};Object.entries(e).forEach((([e,n])=>{var r;null!=(r=t.conditions)&&r[e]&&(i=W(i,n))}));const l=null==(o=c.find((({elements:t})=>t.includes(r))))?void 0:o.timeline;((t,e,r)=>{var o;const i=e.tl?null==(o=Object.values(e.tl))?void 0:o[0]:void 0;if(e.to&&e.from)r?r.fromTo(T(t,e),e.from,e.to,i):n.fromTo(T(t,e),e.from,e.to);else if(e.to||e.from){const o=e.to?"to":"from";r?r[o](T(t,e),e[o],i):n[o](T(t,e),e[o])}})(r,i,l)}))}))}function h(){s=[],c=[],a=new Map}function b(){c.forEach((({timeline:t})=>{t.kill()})),a.forEach(((t,e)=>{n.killTweensOf(e)})),h()}return m(),{init:m,kill:b,restart:function(){b(),p(),m()},data:{breakpoints:l,elements:s,timelines:c,animations:a}}}export{I as glaze};