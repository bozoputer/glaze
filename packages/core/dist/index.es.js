function v(t,e,n=!1){var l;let r="string"!=typeof e?null==(l=null==e?void 0:e.selector)?void 0:l.value:"";if(r){if(r=r.replaceAll("_"," "),r.startsWith("&")){const e=null==r?void 0:r.replace("&",":scope");return n?t.querySelector(e):t.querySelectorAll(e)}return r}return t}function W(t){return!(null===t||"object"!=typeof t||Array.isArray(t)||t instanceof HTMLElement)}function x(t,...e){if(!e.length)return t;const n=e.shift();if(W(t)&&W(n))for(const e in n)"__proto__"===e||"constructor"===e||"prototype"===e||(W(n[e])?(t[e]||Object.assign(t,{[e]:{}}),x(t[e],n[e])):Object.assign(t,{[e]:n[e]}));return e.length?x(t,...e):t}function V(t){const e=t.match(/^\[([^\]]+)]:(.*)/);return e?{content:e[1],restOfString:e[2]}:null}function C(t,e,n){if("string"!=typeof t)return t;const l=t.replace(/^\[|]$/g,"").replaceAll("_"," ");return l.startsWith("&")?v(e,t,["trigger"].includes(n)):"true"===l||"false"===l?"true"===l:isNaN(Number(l))?l:l.includes(".")?parseFloat(l):parseInt(l,10)}function F(t,e=!1,n){const l={};return t.split(" ").forEach((t=>{var r;const i=V(t);i&&(t=i.restOfString,l.selector={},l.selector.value=i.content);const s=t.split(":").filter((t=>!t.includes("@"))),[o,a]=s;if(!a&&e){const e=t.split("-"),r=e[0],i=e[1];if(!r||!i)return;return void(l[r]=C(i,n,r))}if("tl"===o&&a.startsWith("["))return void(l.tl={value:null==(r=V(a+":"))?void 0:r.content});if(!a)return;const c=a.split("|");l[o]||(l[o]={}),c.forEach((t=>{if(!t)return;let[e,r]=t.split(/-(.+)/);r=C(r,n,e);const i=e.split(".");let s=l[o];i.forEach(((t,e)=>{e===i.length-1?s[t]=r:(s[t]||(s[t]={}),s=s[t])}))}))})),l}function K(t,e,n){const l=t.match(/(?:@(\w+):)?tl(?:\/(\w+))?/);if(l){const t=l[1],r={id:l[2]??"",breakpoint:n};if(t){if(null==e||!e[t])return null;r.breakpoint=e[t]??n}return r}return null}function L(t,e,n){const l={};return t.split(" ").forEach((t=>{const r=t.match(/@(\w+):/);if(!r)return l[n]||(l[n]=[]),void l[n].push(t);const i=r[1],s=null==e?void 0:e[i];s&&(l[s]||(l[s]=[]),l[s].push(t.replace(r[0],"")))})),l}function Q(t,e){let n=null;return function(...l){null!==n&&clearTimeout(n),n=window.setTimeout((()=>{t(...l)}),e)}}function R(t){var e,n,l;if(!t||null==(n=null==(e=null==t?void 0:t.lib)?void 0:e.gsap)||!n.core)throw new Error("GSAP not found");const{lib:{gsap:{core:r}},...i}=t,s=x({breakpoints:{default:"(min-width: 1px)"},dataAttribute:"data-animate",element:document,watch:!1},i),o=null==(l=s.breakpoints)?void 0:l.default,a=s.breakpoints,c=[],u=(t=!1)=>`${t?"[":""}${s.dataAttribute}${t?"]":""}`,f=t=>{const e=t.getAttribute(u())||"";let n="";return null!=s&&s.className&&(n=(t.getAttribute("class")||"").split(" ").filter((t=>t.includes(s.className))).map((t=>t.replace(`${null==s?void 0:s.className}-`,""))).join(" ")),`${e} ${n}`.trim()},d=(t=s.element)=>Array.from(t.querySelectorAll(`${u(!0)}${s.className?`, [class^="${s.className}"], [class*="${s.className}"]`:""}`)),m=()=>Math.random().toString(36).substring(2,15),p=t=>"tl"===t||t.includes("tl/")||t.endsWith(":tl"),b=t=>c.find((e=>e.elements.has(t))),h=(t,e="")=>{if(e){const n=c.findIndex((t=>t.id===e));if(-1===n)return;c[n]=t}else c.push(t)},g=Q((function(t){const e=b(t.target);null!=e&&e.timeline&&(e.timeline.progress(0).clear(),A([...Array.from(e.elements.keys()),...null!=e&&e.timelineElement?[null==e?void 0:e.timelineElement]:[]],(null==e?void 0:e.id)||""))}),"object"==typeof s.watch&&s.watch.debounceTime||500);function E(t){const e=[...Object.entries(L(f(t),a,o)).map((([e,n])=>({breakpoint:e,element:t,data:F(n.join(" "),!1,t)})))],n={};return e.forEach((t=>{null!=n&&n[t.breakpoint]||(n[t.breakpoint]={}),n[t.breakpoint]=t.data})),n}function N(t=d(),e=""){const n=[];t.forEach((t=>{f(t).split(" ").some((t=>p(t)))&&(n.push(...function(t,e=""){const n=[],l=f(t),i=l.split(" ");if(i.some((t=>p(t)))){const c=K(l,a,o),u=new Map;[...d(t),...null!=c&&c.id?document.querySelectorAll(`[${s.dataAttribute}*="tl:${c.id}"]${s.className?`, [class^="${s.className}-tl:${c.id}"], [class*="${s.className}-tl:${c.id}"]`:""}`):[]].forEach((e=>{e!==t&&(u.set(e,E(e)),n.push(e))}));const f=F(i.filter((t=>!p(t))).join(" "),!0,t),b=(null==c?void 0:c.breakpoint)||o;h({breakpoint:b,data:f,elements:u,id:(null==c?void 0:c.id)||m(),timelineElement:t,timeline:r.timeline({...f,paused:!0})},e)}return n}(t)),n.push(t))})),t.forEach((t=>{var l;if(n.includes(t))return;const i=null==(l=c.find((e=>{var n;return(null==(n=e.elements)?void 0:n.has(t))&&e.breakpoint})))?void 0:l.breakpoint,s=c.find((e=>{var n;return null==(n=e.elements)?void 0:n.has(t)})),a=new Map;(!s||""!==e)&&(a.set(t,E(t)),h({breakpoint:i||o,data:{},elements:a,id:(null==s?void 0:s.id)||m(),timelineElement:t,timeline:r.timeline({paused:!0})},e))})),console.log("breakpoints:",a),console.log("timelines:",c)}function A(t=d(),e=""){N(t,e),r.matchMedia().add(Object.fromEntries(Object.values({[o]:o,...a||{}}).map((t=>[t,t]))),(t=>{(e?[c.find((t=>t.id===e))]:c).reduce(((t,e)=>new Map([...t,...e.elements])),new Map).forEach(((n,l)=>{let i={};Object.entries(n).forEach((([e,n])=>{var l;null!=(l=t.conditions)&&l[e]&&(i=x(i,n))}));const s=b(l);s&&(e&&s.timeline.progress(0).clear(),s.elements.forEach(((t,e)=>{r.set(e,{clearProps:"all"}),Object.values(t).forEach((t=>{t.selector&&r.set(v(e,t),{clearProps:"all"})}))})),function(t,e,n){var l;const r=e.tl?null==(l=Object.values(e.tl))?void 0:l[0]:void 0;if(e.to&&e.from)n.fromTo(v(t,e),e.from,e.to,r);else if(e.to||e.from){const l=e.to?"to":"from";n[l](v(t,e),e[l],r)}}(l,i,s.timeline),s.timeline.restart())}))}))}return A(),s.watch&&function(){const t=s.element,e=new MutationObserver((function(t){t.forEach((function(t){var e,n;const l="attributes"===t.type&&t.attributeName===s.dataAttribute,r=s.className&&"class"===t.attributeName&&(null==(e=t.target.getAttribute("class"))?void 0:e.includes(s.className));if(!l&&!r)return;const i=E(t.target),o=null==(n=c.find((e=>e.elements.has(t.target))))?void 0:n.elements.get(t.target);JSON.stringify(i)!==JSON.stringify(o)&&(!o||!i||g(t))}))})),n={attributes:!0,attributeFilter:[s.dataAttribute,...s.className?["class"]:[]],subtree:!0};e.observe(t,n)}(),{breakpoints:a,state:s,timelines:c}}export{R as default};