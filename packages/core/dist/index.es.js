function C(t,e,n=!1){var i;let l="string"!=typeof e?null==(i=null==e?void 0:e.selector)?void 0:i.value:"";if(l){if(l=l.replaceAll("_"," "),l.startsWith("&")){const e=null==l?void 0:l.replace("&",":scope");return n?t.querySelector(e):t.querySelectorAll(e)}return l}return t}function x(t){return!(null===t||"object"!=typeof t||Array.isArray(t)||t instanceof HTMLElement)}function W(t,...e){if(!e.length)return t;const n=e.shift();if(x(t)&&x(n))for(const e in n)"__proto__"===e||"constructor"===e||"prototype"===e||(x(n[e])?(t[e]||Object.assign(t,{[e]:{}}),W(t[e],n[e])):Object.assign(t,{[e]:n[e]}));return e.length?W(t,...e):t}function H(t){const e=t.match(/^\[([^\]]+)]:(.*)/);return e?{content:e[1],restOfString:e[2]}:null}function z(t,e,n){if("string"!=typeof t)return t;const i=t.replace(/^\[|]$/g,"").replaceAll("_"," ");return i.startsWith("&")?C(e,t,["trigger"].includes(n)):"true"===i||"false"===i?"true"===i:isNaN(Number(i))?i:i.includes(".")?parseFloat(i):parseInt(i,10)}function B(t,e=!1,n){const i={};return t.split(" ").forEach((t=>{var l;const r=H(t);r&&(t=r.restOfString,i.selector={},i.selector.value=r.content);const s=t.split(":").filter((t=>!t.includes("@"))),[o,a]=s;if(!a&&e){const e=t.split("-"),l=e[0],r=e[1];if(!l||!r)return;return void(i[l]=z(r,n,l))}if("tl"===o&&a.startsWith("["))return void(i.tl={value:null==(l=H(a+":"))?void 0:l.content});if(!a)return;const c=a.split("|");i[o]||(i[o]={}),c.forEach((t=>{if(!t)return;let[e,l]=t.split(/-(.+)/);l=z(l,n,e);const r=e.split(".");let s=i[o];r.forEach(((t,e)=>{e===r.length-1?s[t]=l:(s[t]||(s[t]={}),s=s[t])}))}))})),i}function U(t,e,n){const i=t.match(/(?:@(\w+):)?tl(?:\/(\w+))?/);if(i){const t=i[1],l={id:i[2]??"",breakpoint:n};if(t){if(null==e||!e[t])return null;l.breakpoint=e[t]??n}return l}return null}function X(t,e,n){const i={};return t.split(" ").forEach((t=>{const l=t.match(/@(\w+):/);if(!l)return i[n]||(i[n]=[]),void i[n].push(t);const r=l[1],s=null==e?void 0:e[r];s&&(i[s]||(i[s]=[]),i[s].push(t.replace(l[0],"")))})),i}function Y(t,e){let n=null;return function(...i){null!==n&&clearTimeout(n),n=window.setTimeout((()=>{t(...i)}),e)}}function Z(t){var e,n,i;if(!t||null==(n=null==(e=null==t?void 0:t.lib)?void 0:e.gsap)||!n.core)throw new Error("GSAP not found");const{lib:{gsap:{core:l}},...r}=t,s=W({breakpoints:{default:"(min-width: 1px)"},dataAttribute:"data-animate",element:document,watch:!1},r);let o=0;const a=null==(i=s.breakpoints)?void 0:i.default,c=s.breakpoints,u=[],f=(t=!1)=>`${t?"[":""}${s.dataAttribute}${t?"]":""}`,d=t=>{const e=t.getAttribute(f())||"";let n="";return null!=s&&s.className&&(n=(t.getAttribute("class")||"").split(" ").filter((t=>t.includes(s.className))).map((t=>t.replace(`${null==s?void 0:s.className}-`,""))).join(" ")),`${e} ${n}`.trim()},m=(t=s.element)=>Array.from(t.querySelectorAll(`${f(!0)}${s.className?`, [class^="${s.className}"], [class*="${s.className}"]`:""}`)),p=()=>(o++,`${Math.random().toString(36).substring(2,15)}-${o}`),b=t=>"tl"===t||t.includes("tl/")||t.endsWith(":tl"),h=t=>u.find((e=>e.elements.has(t))),v=t=>u.find((e=>e.id===t)),g=t=>{const e=t.id,n=u.findIndex((t=>t.id===e));e&&-1!==n?u[n]={...t,timeline:u[n].timeline}:u.push(t)};function E(t){const e=u.find((e=>e.timelineElement===t||e.timelineElement.id&&t.id&&e.timelineElement.id===t.id));return e?e.id:""}function N(t){var e;const n=A(t),i=null==(e=u.find((e=>e.elements.has(t))))?void 0:e.elements.get(t);return JSON.stringify(n)!==JSON.stringify(i)&&(!i||!n||JSON.stringify(n)!==JSON.stringify(i))}const y=Y((function(t,e=""){if(e)return void k([t],e);const n=h(t);if(null==n||!n.timeline){let e="";if(Object.values(A(t)).forEach((t=>{e||t.tl&&(e=Object.keys(t.tl)[0])})),e||(e=E(t)),!e)return void k([t],p());const n=v(e),i=[null==n?void 0:n.timelineElement,...(null==n?void 0:n.elements.keys())||[],t];return null==n||n.timeline.progress(0).clear(),void k(i,e)}k([...Array.from(n.elements.keys()),...null!=n&&n.timelineElement?[null==n?void 0:n.timelineElement]:[]],(null==n?void 0:n.id)||"")}),"object"==typeof s.watch&&s.watch.debounceTime||500);function A(t){const e=[...Object.entries(X(d(t),c,a)).map((([e,n])=>({breakpoint:e,element:t,data:B(n.join(" "),!1,t)})))],n={};return e.forEach((t=>{null!=n&&n[t.breakpoint]||(n[t.breakpoint]={}),n[t.breakpoint]=t.data})),n}function $(t=m(),e=""){const n=[];t.forEach((t=>{d(t).split(" ").some((t=>b(t)))&&(n.push(...function(t,e=""){const n=[],i=d(t),r=i.split(" ");if(r.some((t=>b(t)))){const o=U(i,c,a),u=new Map;[...m(t),...null!=o&&o.id?document.querySelectorAll(`[${s.dataAttribute}*="tl:${o.id}"]${s.className?`, [class^="${s.className}-tl:${o.id}"], [class*="${s.className}-tl:${o.id}"]`:""}`):[]].forEach((e=>{e!==t&&(u.set(e,A(e)),n.push(e))}));const f=B(r.filter((t=>!b(t))).join(" "),!0,t),d=(null==o?void 0:o.breakpoint)||a;g({breakpoint:d,data:f,elements:u,id:e||(null==o?void 0:o.id)||p(),timelineElement:t,timeline:l.timeline({...f,paused:!0})})}return n}(t)),n.push(t))})),t.forEach((t=>{var i;if(n.includes(t))return;const r=null==(i=u.find((e=>{var n;return(null==(n=e.elements)?void 0:n.has(t))&&e.breakpoint})))?void 0:i.breakpoint,s=h(t),o=new Map;(!s||""!==e)&&(o.set(t,A(t)),g({breakpoint:r||a,data:{},elements:o,id:e||(null==s?void 0:s.id)||p(),timelineElement:t,timeline:l.timeline({paused:!0})}))})),console.log("breakpoints:",c),console.log("timelines:",u)}function k(t=m(),e=""){$(t,e),l.matchMedia().add(Object.fromEntries(Object.values({[a]:a,...c||{}}).map((t=>[t,t]))),(t=>{if(e){const t=v(e);t&&t.timeline.progress(0).clear()}(e?[u.find((t=>t.id===e))]:u).reduce(((t,e)=>new Map([...t,...e.elements])),new Map).forEach(((e,n)=>{let i={};Object.entries(e).forEach((([e,n])=>{var l;null!=(l=t.conditions)&&l[e]&&(i=W(i,n))}));const r=h(n);r&&(r.elements.forEach(((t,e)=>{l.set(e,{clearProps:"all"}),Object.values(t).forEach((t=>{t.selector&&l.set(C(e,t),{clearProps:"all"})}))})),function(t,e,n){var i;const l=e.tl?null==(i=Object.values(e.tl))?void 0:i[0]:void 0;if(e.to&&e.from)n.fromTo(C(t,e),e.from,e.to,l);else if(e.to||e.from){const i=e.to?"to":"from";n[i](C(t,e),e[i],l)}}(n,i,r.timeline),r.timeline.restart())}))}))}return k(),s.watch&&function(){const t=s.element,e=new MutationObserver((function(t){t.forEach((function(t){var e;const n="attributes"===t.type&&t.attributeName===s.dataAttribute,i=s.className&&"class"===t.attributeName&&(null==(e=t.target.getAttribute("class"))?void 0:e.includes(s.className));if(n||i||"childList"===t.type){if("childList"===t.type)return void t.addedNodes.forEach((t=>{var e;if(t.nodeType===Node.ELEMENT_NODE){const n=t;if(n.hasAttribute(s.dataAttribute)||s.className&&null!=(e=n.getAttribute("class"))&&e.includes(s.className)){if(!N(n))return;const t=E(n);return console.log("childList: attribute/class change"),void y(n,t)}{const t=function(t){let e=t.parentElement;for(;e;){if(e.hasAttribute(s.dataAttribute)||Array.from(e.classList).some((t=>t.startsWith(s.className||"")))&&s.watch)return e;e=e.parentElement}return null}(n);if(!t)return;if(t){const e=E(t);if(!e)return;return console.log("childList: closest matching ancestor"),void y(t,e)}}}}));N(t.target)&&(console.log("attribute/class change"),y(t.target))}}))})),n={attributes:!0,attributeFilter:[s.dataAttribute,...s.className?["class"]:[]],subtree:!0,childList:!0};e.observe(t,n)}(),{breakpoints:c,state:s,timelines:u}}export{Z as default};