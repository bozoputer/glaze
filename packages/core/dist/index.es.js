function v(t,e,n=!1){var l;let i="string"!=typeof e?null==(l=null==e?void 0:e.selector)?void 0:l.value:"";if(i){if(i=i.replaceAll("_"," "),i.startsWith("&")){const e=null==i?void 0:i.replace("&",":scope");return n?t.querySelector(e):t.querySelectorAll(e)}return i}return t}function T(t){return!(null===t||"object"!=typeof t||Array.isArray(t)||t instanceof HTMLElement)}function M(t,...e){if(!e.length)return t;const n=e.shift();if(T(t)&&T(n))for(const e in n)"__proto__"===e||"constructor"===e||"prototype"===e||(T(n[e])?(t[e]||Object.assign(t,{[e]:{}}),M(t[e],n[e])):Object.assign(t,{[e]:n[e]}));return e.length?M(t,...e):t}function q(t){const e=t.match(/^\[([^\]]+)]:(.*)/);return e?{content:e[1],restOfString:e[2]}:null}function V(t,e,n){if("string"!=typeof t)return t;const l=t.replace(/^\[|]$/g,"").replaceAll("_"," ");return l.startsWith("&")?v(e,t,["trigger"].includes(n)):"true"===l||"false"===l?"true"===l:isNaN(Number(l))?l:l.includes(".")?parseFloat(l):parseInt(l,10)}function F(t,e=!1,n){const l={};return t.split(" ").forEach((t=>{var i;const r=q(t);r&&(t=r.restOfString,l.selector={},l.selector.value=r.content);const o=t.split(":").filter((t=>!t.includes("@"))),[s,a]=o;if(!a&&e){const e=t.split("-"),i=e[0],r=e[1];if(!i||!r)return;return void(l[i]=V(r,n,i))}if("tl"===s&&a.startsWith("["))return void(l.tl={value:null==(i=q(a+":"))?void 0:i.content});if(!a)return;const u=a.split("|");l[s]||(l[s]={}),u.forEach((t=>{if(!t)return;let[e,i]=t.split(/-(.+)/);i=V(i,n,e);const r=e.split(".");let o=l[s];r.forEach(((t,e)=>{e===r.length-1?o[t]=i:(o[t]||(o[t]={}),o=o[t])}))}))})),l}function L(t,e,n){const l=t.match(/(?:@(\w+):)?tl(?:\/(\w+))?/);if(l){const t=l[1],i={id:l[2]??"",breakpoint:n};if(t){if(null==e||!e[t])return null;i.breakpoint=e[t]??n}return i}return null}function Q(t,e,n){const l={};return t.split(" ").forEach((t=>{const i=t.match(/@(\w+):/);if(!i)return l[n]||(l[n]=[]),void l[n].push(t);const r=i[1],o=null==e?void 0:e[r];o&&(l[o]||(l[o]=[]),l[o].push(t.replace(i[0],"")))})),l}function J(t,e){let n=null;return function(...l){null!==n&&clearTimeout(n),n=window.setTimeout((()=>{t(...l)}),e)}}function R(t){var e,n;if(!t||null==(n=null==(e=null==t?void 0:t.lib)?void 0:e.gsap)||!n.core)throw new Error("GSAP not found");const{lib:{gsap:{core:l}},...i}=t,r=M({breakpoints:{default:"(min-width: 1px)"},dataAttribute:"data-animate",element:document,watch:!1},i),o=r.breakpoints.default,s=r.breakpoints,a=[],u=(t=!1)=>`${t?"[":""}${r.dataAttribute}${t?"]":""}`,c=t=>{const e=t.getAttribute(u())||"";let n="";return null!=r&&r.className&&(n=(t.getAttribute("class")||"").split(" ").filter((t=>t.includes(r.className))).map((t=>t.replace(`${null==r?void 0:r.className}-`,""))).join(" ")),`${e} ${n}`.trim()},f=(t=r.element)=>Array.from(t.querySelectorAll(`${u(!0)}${r.className?`, [class^="${r.className}"], [class*="${r.className}"]`:""}`)),d=()=>Math.random().toString(36).substring(2,15),m=t=>"tl"===t||t.includes("tl/")||t.endsWith(":tl"),p=t=>a.find((e=>e.elements.has(t))),b=t=>a.findIndex((e=>e.elements.has(t))),h=J((function(t){const e=p(t.target),n=b(t.target);n>-1&&null!=e&&e.timeline&&(e.timeline.progress(0),e.timeline.kill(),a.splice(n,1),k([...Array.from(e.elements.keys()),...null!=e&&e.timelineElement?[null==e?void 0:e.timelineElement]:[]],!0))}),"object"==typeof r.watch&&r.watch.debounceTime||500);function g(t){const e=[...Object.entries(Q(c(t),s,o)).map((([e,n])=>({breakpoint:e,element:t,data:F(n.join(" "),!1,t)})))],n={};return e.forEach((t=>{null!=n&&n[t.breakpoint]||(n[t.breakpoint]={}),n[t.breakpoint]=t.data})),n}function $(t=f()){const e=[];t.forEach((t=>{c(t).split(" ").some((t=>m(t)))&&(e.push(...function(t){const e=[],n=c(t),l=n.split(" ");if(l.some((t=>m(t)))){const i=L(n,s,o),u=new Map;[...f(t),...null!=i&&i.id?document.querySelectorAll(`[${r.dataAttribute}*="tl:${i.id}"]${r.className?`, [class^="${r.className}-tl:${i.id}"], [class*="${r.className}-tl:${i.id}"]`:""}`):[]].forEach((n=>{n!==t&&(u.set(n,g(n)),e.push(n))}));const c=F(l.filter((t=>!m(t))).join(" "),!0,t),p=(null==i?void 0:i.breakpoint)||o;a.push({breakpoint:p,data:c,elements:u,id:(null==i?void 0:i.id)||d(),timelineElement:t})}return e}(t)),e.push(t))})),t.forEach((t=>{var n;if(e.includes(t))return;const l=null==(n=a.find((e=>{var n;return(null==(n=e.elements)?void 0:n.has(t))&&e.breakpoint})))?void 0:n.breakpoint,i=a.find((e=>{var n;return null==(n=e.elements)?void 0:n.has(t)})),r=new Map;i||(r.set(t,g(t)),a.push({breakpoint:l||o,data:{},elements:r,id:d()}))}))}function k(t=f(),e=!1){$(t),l.matchMedia().add(Object.fromEntries(Object.values({[o]:o,...s||{}}).map((t=>[t,t]))),(t=>{const n={};(e?[a[a.length-1]]:a).reduce(((t,e)=>new Map([...t,...e.elements])),new Map).forEach(((e,i)=>{let r={};Object.entries(e).forEach((([e,n])=>{var l;null!=(l=t.conditions)&&l[e]&&(r=M(r,n))}));const o=p(i),s=b(i);o&&(null!=n&&n[null==o?void 0:o.id]||(n[null==o?void 0:o.id]=l.timeline(null==o?void 0:o.data),a[s].timeline=n[null==o?void 0:o.id]),function(t,e,n){var l;const i=e.tl?null==(l=Object.values(e.tl))?void 0:l[0]:void 0;if(e.to&&e.from)n.fromTo(v(t,e),e.from,e.to,i);else if(e.to||e.from){const l=e.to?"to":"from";n[l](v(t,e),e[l],i)}}(i,r,n[null==o?void 0:o.id]))}))}))}return k(),r.watch&&function(){const t=r.element,e=new MutationObserver((function(t){t.forEach((function(t){("attributes"===t.type&&t.attributeName===r.dataAttribute||r.className&&"class"===t.attributeName)&&h(t)}))})),n={attributes:!0,attributeFilter:[r.dataAttribute,...r.className?["class"]:[]],subtree:!0};e.observe(t,n)}(),{breakpoints:s,state:r,timelines:a}}export{R as default};